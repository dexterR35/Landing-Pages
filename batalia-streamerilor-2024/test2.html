<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LivePartners API Interaction</title>
    <!-- Include jQuery Library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
    $(document).ready(function() {
        // Replace 'your_valid_token_here' with the actual token obtained from LivePartners
        const token = 'b4e5754e-4662-4fe7-9750-b3db60571cb8';
        const baseUrl = 'https://qaadmin.livepartners.com/api/streaming/';
        const username = 'TESTCOZMINN'; // Replace with the desired player's username

        // Function to add a new player to the table
        function addPlayer(username) {
            $.ajax({
                url: baseUrl + 'optin/' + username,
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + token
                },
                success: function(response) {
                    console.log('Player added successfully:', response);
                },
                error: function(xhr, status, error) {
                    console.error('Error adding player:', xhr.responseText);
                }
            });
        }

        // Function to delete a player from the table
        function deletePlayer(username) {
            $.ajax({
                url: baseUrl + 'optout/' + username,
                type: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + token
                },
                success: function(response) {
                    console.log('Player deleted successfully:', response);
                },
                error: function(xhr, status, error) {
                    console.error('Error deleting player:', xhr.responseText);
                }
            });
        }

        // Function to check if a player exists in the table
        function checkPlayerExists(username) {
            $.ajax({
                url: baseUrl + 'check/' + username,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + token
                },
                success: function(response) {
                    console.log('Player exists:', response);
                },
                error: function(xhr, status, error) {
                    console.error('Error checking player existence:', xhr.responseText);
                }
            });
        }

        // Function to retrieve statistics
        function getStatistics(filtered = true) {
            const endpoint = filtered ? 'data' : 'data/0';
            $.ajax({
                url: baseUrl + endpoint,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + token
                },
                success: function(response) {
                    console.log('Statistics retrieved:', response);
                },
                error: function(xhr, status, error) {
                    console.error('Error retrieving statistics:', xhr.responseText);
                }
            });
        }

        // Function to test and check database records
        function testDatabase(username = '') {
            const endpoint = username ? 'get/' + username : 'get/';
            $.ajax({
                url: baseUrl + endpoint,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + token
                },
                success: function(response) {
                    console.log('Database test successful:', response);
                },
                error: function(xhr, status, error) {
                    console.error('Error testing database:', xhr.responseText);
                }
            });
        }

        // Event listeners for button clicks

        // Add a new player
        $('#addPlayerBtn').click(function() {
            addPlayer(username);
        });

        // Delete a player
        $('#deletePlayerBtn').click(function() {
            deletePlayer(username);
        });

        // Check if player exists
        $('#checkPlayerBtn').click(function() {
            checkPlayerExists(username);
        });

        // Get statistics (filtered)
        $('#getStatsBtn').click(function() {
            getStatistics(true);
        });

        // Get statistics (unfiltered)
        $('#getAllStatsBtn').click(function() {
            getStatistics(false);
        });

        // Test database for a specific player
        $('#testDbBtn').click(function() {
            testDatabase(username);
        });

        // Test database for all records
        $('#testDbAllBtn').click(function() {
            testDatabase();
        });
    });
    </script>
</head>
<body>

    <h1>LivePartners API Interaction</h1>

    <button id="addPlayerBtn">Add Player</button>
    <button id="deletePlayerBtn">Delete Player</button>
    <button id="checkPlayerBtn">Check Player Exists</button>
    <button id="getStatsBtn">Get Statistics (Filtered)</button>
    <button id="getAllStatsBtn">Get Statistics (Unfiltered)</button>
    <button id="testDbBtn">Test Database (Specific Player)</button>
    <button id="testDbAllBtn">Test Database (All Records)</button>

</body>
</html>
