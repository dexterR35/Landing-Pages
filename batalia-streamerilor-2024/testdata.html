<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataTable Example</title>
    <!-- Include DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
</head>
<body>
    <table id="userTable" class="display">
        <thead>
            <tr>
                <th>Position</th>
                <th>Username</th>
                <th>Ranking (Points)</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <!-- Include jQuery and DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>

    <!-- Include the custom JavaScript file -->
<script>
 $(document).ready(function() {
    const users = [];

    // Adăugăm 2000 de utilizatori cu id unic și ranking (clasament) crescător
    for (let i = 1; i <= 2000; i++) {
        users.push({ id: i, username: `User${i}`, ranking: 2001 - i }); // Ranking scade pe măsură ce avansăm
    }

    // Setăm MyUsername pe o poziție random (de exemplu poziția 400)
    const randomPosition = Math.floor(Math.random() * 2000); // Poziție random în intervalul 1-2000
    users[randomPosition].username = 'MyUsername';

    // Step 1: Get top 3 users
    const top3 = users.slice(0, 3); // Primii 3 utilizatori

    // Step 2: Găsim utilizatorul 'MyUsername' și vecinii săi (indiferent de poziție)
    const myUsernameIndex = users.findIndex(user => user.username === 'MyUsername'); // Găsim poziția lui MyUsername
    const beforeAndAfter = [];

    // Verificăm dacă există vecini înainte și după utilizator pentru a preveni erori
    if (myUsernameIndex > 0) {
        beforeAndAfter.push(users[myUsernameIndex - 1]); // Adăugăm vecinul dinainte, dacă există
    }
    beforeAndAfter.push(users[myUsernameIndex]); // Adăugăm utilizatorul
    if (myUsernameIndex < users.length - 1) {
        beforeAndAfter.push(users[myUsernameIndex + 1]); // Adăugăm vecinul de după, dacă există
    }

    // Step 3: Luăm ultimii 4 utilizatori
    const last4 = users.slice(-4); // Ultimii 4 utilizatori

    // Step 4: Combinăm toate datele selectate
    const combinedData = [
        ...top3,
        ...beforeAndAfter,
        ...last4
    ];

    // Step 5: Inițializăm DataTables cu datele combinate
    $('#userTable').DataTable({
        data: combinedData,
        columns: [
            { data: 'id', title: 'ID' }, // Coloana ID unic
            { data: 'username', title: 'Username' }, // Coloana username
            { data: 'ranking', title: 'Ranking (Points)' } // Coloana cu clasament (puncte)
        ],
        paging: false,  // Fără paginare
        searching: false,  // Fără căutare
        info: false  // Ascundere informații despre tabel
    });
});



//                function addStreamers(username) {
//   $.ajax({
//     url: url + 'streamer/' + username + '/' + 1,
//     type: 'POST',
//     headers: {
//         'Authorization': 'Bearer ' + token
//     },
//     success: function(response) {
//         console.log('response stre:', response);
//     },
//     error: function(xhr, status, error) {
//         console.log('response:', error);
//     }
// });
//  }

//  addStreamers(username);

// function adTest(username) {
//  $.ajax({
//     url: url + 'get/' + username, //To check 1 player all fields in our DB
//     //url: url + 'get/', //Without username return all records in DB
//     type: 'GET',
//     headers: {
//         'Authorization': 'Bearer ' + token
//     },
//     success: function(response) {
//         console.log('response:', response);
//     },
//     error: function(xhr, status, error) {
//         console.log('response:', error);
//     }
// });
// }
// adTest(username);

</script>
</body>
</html>
