<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"
      integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <style></style>
    <title>Document</title>
  </head>

  <body>
    <div class="chartMenu">
      <p></p>
    </div>
    <div class="chartCard">
      <div class="chartBox">
        <canvas
          id="myChart"
          style="position: relative; height: 40vh; width: 100%"
          role="img"
        ></canvas>
      </div>
    </div>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/chart.js"
    ></script>
    <script>
      // setup
      Chart.defaults.font.size = 10;
      //   function beforePrintHandler() {
      //     for (let id in Chart.instances) {
      //       Chart.instances[id].resize();
      //     }
      //   }
      //   $(window).resize(function () {
      //     myChart.resize(600, 600);
      //   });
      //   window.addEventListener("beforeprint", () => {
      //     myChart.resize(600, 600);
      //   });
      //   window.addEventListener("afterprint", () => {
      //     myChart.resize();
      //   });
      async function fetchData() {
        const url = "./test2.json ";
        const response = await fetch(url);
        const data_ = await response.json();
        console.log(data_, "data_");
        return data_;
      }

      function updateChart() {
        fetchData().then((data_) => {
          const players_name = data_.qatar[2].players.map(
            ({ name, price }, index) => {
              console.log("index", price);
              return name;
            }
          );
          const players_price = data_.qatar[2].players.map(
            ({ price }, index) => {
              return price;
            }
          );

        

          const data_chart_s3 = {
            labels: ["2002", "2006", "2010", "2014", "2018"],
            datasets: [
              {
                label: "BILIONS",
                data: ["1.2", "1.4", "2.4", "2.4", "2.8"],
                backgroundColor: [
                  "rgba(250,174,50,1)",
                  "grey",
                  "rgb(255, 205, 86)",
                ],
              },
            ],
          };
          var options_s3 = {
            maintainAspectRatio: true,
            scales: {
              y: {
                stacked: true,
                grid: {
                  display: true,
                  color: "rgba(255,99,132,0.2)",
                },
              },
              x: {
                grid: {
                  display: false,
                },
              },
            },
          };
          // config
          const config_s3 = {
            type: "bar",
            data: data_chart_s3,
            options: {
              indexAxis: "x",
              plugins: {
                legend: {
                  display: false,
                },
                title: {
                  display: true,
                  text: "Venituri din drepturi media Ã®n miliarde de dolari ",
                },
              },
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                y: {
                  grid: {
                    borderColor: "black",
                    borderWidth:0.5,
                    lineWidth: 1,
                    beginAtZero: true,
                  },
                  min: 0,
                  max: 3,
                  ticks: {
                    callback: function (m) {
                      return "$" + m + "b";
                    },
                  },
                },
                x: {
                    grid:{
                        borderColor:"black",
                        borderWidth:0.5,
                        lineWidth: 0.7,
                    },
                },
              },
              layout: {
                padding: {
                  left: 2,
                  right: 2,
                  bottom: 20,
                  top: 10,
                },
              },
            },
          };
          //   myChart.update();
          const myChart = new Chart(
            document.getElementById("myChart"),
            config_s3
          ).getContext("2d");
        });
      }
      updateChart();
    </script>
  </body>
</html>
